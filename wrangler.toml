name = "remix-duckdb-wasm"
main = "./build/server/index.js"
compatibility_date = "2023-09-22"
compatibility_flags = ["nodejs_compat"]

[site]
bucket = "./public"

[build]
command = "bun run build"

[env.production]
route = ""
vars = { NODE_ENV = "production" }

[env.development]
vars = { NODE_ENV = "development" }

[[headers]]
for = "/*"
[headers.set]
Cross-Origin-Embedder-Policy = "require-corp"
Cross-Origin-Opener-Policy = "same-origin"
Cross-Origin-Resource-Policy = "cross-origin"
Content-Security-Policy = "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob:; worker-src 'self' blob:; style-src 'self' 'unsafe-inline'; font-src 'self' data:; img-src 'self' data:; connect-src 'self' blob: ws: wss:;"

[[headers]]
for = "/duckdb/*"
[headers.set]
Cross-Origin-Embedder-Policy = "require-corp"
Cross-Origin-Opener-Policy = "same-origin"
Cross-Origin-Resource-Policy = "cross-origin"
Cache-Control = "public, max-age=31536000, immutable"
